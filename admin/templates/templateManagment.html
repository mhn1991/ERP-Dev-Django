{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8" />
	<title>Template Management</title>
	<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" name="viewport" />
	<meta content="" name="description" />
	<meta content="" name="author" />
	
	<!-- ================== BEGIN BASE CSS STYLE ================== -->
	<link href="https://fonts.googleapis.com/css?family=Roboto:100,300,400,500,700,900" rel="stylesheet" />
	<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet" />
	<script
	  src="https://code.jquery.com/jquery-3.4.1.min.js"
	  integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo="
	  crossorigin="anonymous"></script>
	<link href="{% static 'assets/css/material/app.min.css' %}" rel="stylesheet" />
	<link href="{% static 'assets/plugins/bootstrap-select/dist/css/bootstrap-select.min.css' %}" rel="stylesheet" />
	<!-- ================== END BASE CSS STYLE ================== -->
</head>
<body>
	<!-- begin #page-loader -->
	<div id="page-loader" class="fade show">
		<div class="material-loader">
			<svg class="circular" viewBox="25 25 50 50">
				<circle class="path" cx="50" cy="50" r="20" fill="none" stroke-width="2" stroke-miterlimit="10"></circle>
			</svg>
			<div class="message">Loading...</div>
		</div>
	</div>
	<!-- end #page-loader -->	
	<!-- begin #page-container -->
	<div id="page-container" class="page-container fade page-sidebar-fixed page-header-fixed page-with-wide-sidebar">
		<!-- begin #header -->
        {% include "admin/header.html" %}
		<!-- end #header -->
		
		<!-- begin #sidebar -->
		{% include "admin/sideBar.html" %}
		<!-- end #sidebar -->
		
		<!-- begin #content -->
		<div id="content" class="content">
		  <div class="panel panel-inverse">
				<div class="panel-heading">
					<h4 class="panel-title"></h4>
					<div class="panel-heading-btn">
						<a href="javascript:;" class="btn btn-xs btn-icon btn-circle btn-default" data-click="panel-expand"><i class="fa fa-expand"></i></a>
						<a href="javascript:;" class="btn btn-xs btn-icon btn-circle btn-success" data-click="panel-reload"><i class="fa fa-redo"></i></a>
						<a href="javascript:;" class="btn btn-xs btn-icon btn-circle btn-warning" data-click="panel-collapse"><i class="fa fa-minus"></i></a>
						<a href="javascript:;" class="btn btn-xs btn-icon btn-circle btn-danger" data-click="panel-remove"><i class="fa fa-times"></i></a>
					</div>
				</div>
				<div class="panel-body">
				  <script>
				    var j = 1;
				    var body = document.querySelector('body');
				    body.addEventListener('keyup', checkTabPress);
				    function addRow(j){				   
					    var table = document.getElementById('table');
					    var tr = document.createElement("tr");
					    for(i=0;i<3;i++){
						var td = document.createElement("td");
						if(i == 0){
						    td.innerHTML = j;
						    tr.appendChild(td);
						    continue;
						}
						if(i == 2){
						    td.setAttribute("class","with-form-control");
						    var input = document.createElement("input");
						    input.setAttribute("class","form-control next");
						    input.setAttribute("type","text");
						    td.appendChild(input);
						    tr.appendChild(td);
						}
						else{
						    td.setAttribute("class","with-form-control");
						    var input = document.createElement("input");
						    input.setAttribute("class","form-control");
						    input.setAttribute("type","text");
						    td.appendChild(input);
						    tr.appendChild(td);
						}
					    }
					table.appendChild(tr);
					return j+=1;
					}

				    function checkTabPress(e) {                                                                                                                  
                                       "use strict";                                                                                                                             
					// pick passed event of global event object   
					e = e || event;
					var activeElement;
					if (e.keyCode == 9) {
					    activeElement = document.activeElement;
					    if (activeElement.tagName.toLowerCase() == 'input' && activeElement.className.match("form-control next")){
						j = addRow(j);
						//alert("slm");
					    }
					}
				    }
				    
				    $(document).ready(function() {
					j = addRow(j);
				    });

				    function sendForm(form){
					var inputs =  document.getElementsByTagName("input");
					for (i = 0; i < inputs.length; i++){
					    if(inputs[i].name == ""){
						inputs[i].name = inputs[i].value;
						//alert(inputs[i].name);
					    }
					}
					
					var data = JSON.stringify($(form).serializeArray());
					console.log(data);
					
					var xmlhttp = new XMLHttpRequest();
					var url = window.location.protocol + "//" + window.location.host + "/" + "addtemplate/";
					xmlhttp.open("POST", url,false);
					xmlhttp.setRequestHeader("Content-Type", "application/json;charset=UTF-8");
					xmlhttp.setRequestHeader("X-CSRFToken", "{{csrf_token}}");
					xmlhttp.send(data);
				    }
				  </script>
				  
				  <form onsubmit="sendForm(this)" id="form">
				    {% csrf_token %}
				    <div class="col-md-12">
				      <label class="control-label">To:</label>
				     <input type="text" class="col-md-11" placeholder="please choose name for the template" name="name"/>
				      <table class="table table-bordered">
					<thead>
					  <tr>
					    <th>#</th>
					    <th>field</th>
					    <th>value</th>
					  </tr>
					</thead>
					<tbody id="table">
					</tbody>
				      </table>
				      <button type="submit" class="btn btn-sm btn-primary m-r-12">Save</button>
				    </div>
				  </form>
				</div>
			</div>
		  
		</div>
		<!-- end #content -->
		
		<!-- begin theme-panel -->
		
		<!-- end theme-panel -->
		
		<!-- begin scroll to top btn -->
		<a href="javascript:;" class="btn btn-icon btn-circle btn-success btn-scroll-to-top fade" data-click="scroll-top"><i class="fa fa-angle-up"></i></a>
		<!-- end scroll to top btn -->
	</div>
	<!-- end page container -->
	
	<!-- ================== BEGIN BASE JS ================== -->
	<script src="{% static 'assets/js/app.min.js' %}"></script>
	<script src="{% static 'assets/js/theme/material.min.js' %}"></script>
	<script src="{% static 'assets/plugins/bootstrap3-wysihtml5-bower/dist/bootstrap3-wysihtml5.all.min.js' %}"></script>
	<script src="{% static 'assets/js/demo/form-wysiwyg.demo.js' %}"></script>
	<script src="{% static 'assets/plugins/bootstrap-select/dist/js/bootstrap-select.min.js' %}"></script>
	<!-- ================== END BASE JS ================== -->
</body>
</html>
